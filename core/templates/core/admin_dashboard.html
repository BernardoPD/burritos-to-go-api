{% extends 'core/base_cliente.html' %}

{% block title %}Panel de Administrador{% endblock %}

{% block content %}
<h2 style="color: #667eea; margin-bottom: 30px;">👨‍💼 Panel de Administración</h2>

<!-- Estadísticas Generales -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <!-- Total Usuarios -->
    <div class="card" style="border-left-color: #17a2b8;">
        <h3>👥 Total Usuarios</h3>
        <p style="font-size: 48px; font-weight: bold; color: #17a2b8; margin: 20px 0;">{{ total_usuarios }}</p>
        <small style="color: #888;">Clientes registrados</small>
    </div>
    
    <!-- Total Productos -->
    <div class="card" style="border-left-color: #ffc107;">
        <h3>📦 Total Productos</h3>
        <p style="font-size: 48px; font-weight: bold; color: #ffc107; margin: 20px 0;">{{ total_productos }}</p>
        <small style="color: #888;">Productos en menú</small>
    </div>
    
    <!-- Total Pedidos -->
    <div class="card" style="border-left-color: #28a745;">
        <h3>🛒 Total Pedidos</h3>
        <p style="font-size: 48px; font-weight: bold; color: #28a745; margin: 20px 0;">{{ total_pedidos }}</p>
        <small style="color: #888;">Pedidos realizados</small>
    </div>
    
    <!-- Ingresos Totales -->
    <div class="card" style="border-left-color: #dc3545;">
        <h3>💰 Ingresos Totales</h3>
        <p style="font-size: 48px; font-weight: bold; color: #dc3545; margin: 20px 0;">${{ ingresos_totales }}</p>
        <small style="color: #888;">Total facturado</small>
    </div>
</div>

<!-- Accesos Rápidos Admin -->
<div class="card">
    <h3>🚀 Accesos Rápidos de Administrador</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
        <a href="/admin/" class="btn btn-primary" style="text-align: center; padding: 20px;">
            ⚙️ Admin de Django
        </a>
        <a href="/admin/core/usuario/" class="btn btn-primary" style="text-align: center; padding: 20px; background: #17a2b8;">
            👥 Gestionar Usuarios
        </a>
        <a href="/admin/core/producto/" class="btn btn-primary" style="text-align: center; padding: 20px; background: #ffc107; color: #000;">
            📦 Gestionar Productos
        </a>
        <a href="/admin/core/pedido/" class="btn btn-primary" style="text-align: center; padding: 20px; background: #28a745;">
            🛒 Gestionar Pedidos
        </a>
        <a href="/admin/core/categoria/" class="btn btn-primary" style="text-align: center; padding: 20px; background: #6f42c1;">
            📋 Gestionar Categorías
        </a>
    </div>
</div>

<!-- Pedidos Pendientes -->
<div class="card" style="margin-top: 30px;">
    <h3>⏳ Pedidos Pendientes (Requieren Atención)</h3>
    
    {% if pedidos_pendientes %}
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Productos</th>
                <th>Total</th>
                <th>Fecha</th>
                <th>Acción</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in pedidos_pendientes %}
            <tr>
                <td><strong>#{{ pedido.id }}</strong></td>
                <td>{{ pedido.cliente.username }}</td>
                <td>{{ pedido.productos.count }} productos</td>
                <td style="font-weight: bold; color: #28a745;">${{ pedido.total }}</td>
                <td>{{ pedido.fecha|date:"d/m/Y H:i" }}</td>
                <td>
                    <a href="/admin/core/pedido/{{ pedido.id }}/change/" class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;">
                        Ver Detalles
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #888; padding: 20px; text-align: center;">No hay pedidos pendientes</p>
    {% endif %}
</div>

<!-- Últimos Usuarios Registrados -->
<div class="card" style="margin-top: 30px;">
    <h3>👥 Últimos Usuarios Registrados</h3>
    
    {% if ultimos_usuarios %}
    <table>
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Email</th>
                <th>Rol</th>
                <th>Saldo</th>
                <th>Fecha Registro</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in ultimos_usuarios %}
            <tr>
                <td><strong>{{ usuario.username }}</strong></td>
                <td>{{ usuario.email }}</td>
                <td>
                    {% if usuario.rol == 'admin' %}
                        <span style="background: #dc3545; padding: 5px 10px; border-radius: 4px; color: white;">Admin</span>
                    {% else %}
                        <span style="background: #17a2b8; padding: 5px 10px; border-radius: 4px; color: white;">Cliente</span>
                    {% endif %}
                </td>
                <td style="font-weight: bold; color: #28a745;">${{ usuario.saldo }}</td>
                <td>{{ usuario.date_joined|date:"d/m/Y" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>

<!-- Resumen por Categorías -->
<div class="card" style="margin-top: 30px;">
    <h3>📊 Productos por Categoría</h3>
    
    {% if categorias_stats %}
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
        {% for cat in categorias_stats %}
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border: 2px solid #667eea;">
            <h4 style="color: #667eea; margin: 0 0 10px 0;">{{ cat.nombre }}</h4>
            <p style="font-size: 36px; font-weight: bold; color: #28a745; margin: 0;">{{ cat.total }}</p>
            <small style="color: #888;">productos</small>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>

{% endblock %}
